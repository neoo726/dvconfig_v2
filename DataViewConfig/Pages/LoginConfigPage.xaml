<UserControl x:Name="LoginConfigWin" x:Class="DataViewConfig.Pages.LoginConfigPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:DataViewConfig.Pages"
             xmlns:controls="clr-namespace:DataViewConfig.Controls"
             xmlns:converter="clr-namespace:DataViewConfig.Converters" 
             xmlns:vm="clr-namespace:DataViewConfig.ViewModels" 
             xmlns:dv_config="clr-namespace:DataView_Configuration;assembly=DataView_Configuration"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:current="clr-namespace:DataViewConfig"
             xmlns:attachProps="clr-namespace:DataViewConfig.AttachProps"
             d:DataContext="{d:DesignInstance Type=vm:LoginConfigViewModel}"
             mc:Ignorable="d" 
             d:DesignHeight="736" d:DesignWidth="1296" 
             Background="{StaticResource Content.BackGround}" Foreground="White" FontSize="12"
             Margin="5"
             FontFamily="pack://application:,,,/DataViewConfig;component/Fonts/fontawesome-webfont.ttf#FontAwesome">
    <UserControl.Resources>
        <converter:Bool2InverseConverter x:Key="Bool2Reverse"/>
        <converter:Bool2VisibilityConverter x:Key="Bool2Visibility"/>
        <converter:PasswordConverter x:Key="PwdConverter" />
        <converter:UmsType2VisibilityConverter x:Key="UmsLocal2Visibility"/>
        <ObjectDataProvider x:Key="loginTypeEnum" MethodName="GetValues" ObjectType="{x:Type sys:Enum}" >
            <ObjectDataProvider.MethodParameters>
                <x:Type Type="dv_config:UmsTypeEnum" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <Style TargetType="DataGridCell">
            <Setter Property="FontSize" Value="15"/>
            <Style.Resources>
                <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>
            </Style.Resources>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <!--<Setter Property="Foreground" Value="Red"/>-->
                    <Setter Property="Background" Value="#004696"/>
                    <Setter Property="BorderBrush" Value="Transparent"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    <StackPanel Orientation="Vertical">
        <!--添加接口-->
        <GroupBox Header="登录配置" Style="{StaticResource NormalGroupBox}">
            <StackPanel Orientation="Vertical">
                <StackPanel Orientation="Horizontal" Margin="5">
                    <Label Content="用户校验"  HorizontalContentAlignment="Left" Margin="5,0,5,0" 
                    Style="{StaticResource NormalLabel}"/>
                    <controls:TipsLabel   TipName="[login_config]user_check_type" />
                    <StackPanel Orientation="Horizontal" Margin="50 5 0 5" >
                        <!--<Label Content="通讯类型" HorizontalContentAlignment="Left" Width="150" Style="{StaticResource NormalLabel}" />-->
                        <RadioButton x:Name="LocalLoginRadioBtn" 
                                 IsChecked="{Binding LocalLoginEnable}" 
                                 Content="本地登录"  Style="{StaticResource NormalRadioButton}" Margin="0 0 50 0">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Checked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                                <i:EventTrigger EventName="Unchecked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </RadioButton>
                        <RadioButton x:Name="UMSDVLoginRadioBtn"
                                  IsChecked="{Binding UmsDvLoginEnable}" 
                              Content="UMS__DV"  Style="{StaticResource NormalRadioButton}"  Margin="0 0 50 0">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Checked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                                <i:EventTrigger EventName="Unchecked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </RadioButton>
                        <RadioButton x:Name="UMSECSLoginRadioBtn"
                                  IsChecked="{Binding UmsEcsLoginEnable}" 
                              Content="UMS__ECS"  Style="{StaticResource NormalRadioButton}"  Margin="0 0 50 0">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Checked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                                <i:EventTrigger EventName="Unchecked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </RadioButton>
                        <RadioButton x:Name="UMSOtherLoginRadioBtn"
                                  IsChecked="{Binding UmsOtherLoginEnable}" 
                              Content="自定义校验方式"  Style="{StaticResource NormalRadioButton}"  Margin="0 0 10 0">
                            
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Checked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                                <i:EventTrigger EventName="Unchecked">
                                    <i:InvokeCommandAction Command="{Binding UserSystemSelectedChangeCommand}" >
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </RadioButton>
                       
                    </StackPanel>
                </StackPanel>
                <StackPanel  Visibility="{Binding ElementName=NeedUserAuthChkbox,Path=IsChecked,Converter={StaticResource Boolean2VisibilityReConverter}}">
                    <StackPanel Orientation="Vertical" Visibility="{Binding LocalLoginEnable,Converter={StaticResource Bool2Visibility}}">
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0">
                            <Label Content="本地用户列表" Width="150" HorizontalContentAlignment="Left" HorizontalAlignment="Left" Style="{StaticResource NormalLabel}"/>
                            <controls:TipsLabel   TipName="[login_config_page]local_user_list" />
                            <Button Content="添加" Background="#4c4c4c" Width="100" Height="25" Margin="10" Style="{StaticResource NormalButton}" 
                        Command="{Binding AddNewLocalUserCommand}" CommandParameter=""></Button>
                            <Button Content="导入" Background="#4c4c4c" Width="100" Command="{Binding ImportCsvCommand}" 
            Style="{StaticResource NormalButton}" Margin="700,0,5,0"/>
                            <Button Content="导出" Background="#4c4c4c" Width="100" Command="{Binding ExportCsvCommand}" 
            Style="{StaticResource NormalButton}" Margin="20,0,5,0"/>

                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="5"
                        Visibility="{Binding ShowLocalUserEdit,Converter={StaticResource Bool2Visibility}}">
                            <TextBlock Text="用户ID"  Style="{StaticResource NormalText}" Margin="5 0 5 0"/>
                            <TextBox Text="{Binding EditUserID}" Style="{StaticResource NormalTextBox}" Margin="5 0 5 0"/>
                            <!--<TextBlock Text="用户名"  Style="{StaticResource NormalText}" Margin="5 0 5 0"/>
                <TextBox Text="{Binding EditUserName}" Style="{StaticResource NormalTextBox}" Margin="5 0 5 0"/>-->
                            <TextBlock Text="密码"  Style="{StaticResource NormalText}" Margin="5 0 5 0"/>
                            <!--<TextBox Text="{Binding EditUserPwd}" Style="{StaticResource NormalTextBox}" Margin="5 0 5 0"/>-->
                            <PasswordBox  attachProps:PasswordBoxHelper.Attach="True" attachProps:PasswordBoxHelper.Password="{Binding EditUserPwd, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
              Style="{StaticResource NormalPasswordBox}" Margin="5 0 5 0"/>
                         
                            <Button Content="确认"  Width="100" Height="25" Margin="10" Style="{StaticResource NormalButton}" 
                        Command="{Binding ConfirmLocalUserCommand}" CommandParameter=""></Button>
                        </StackPanel>
                        <DataGrid x:Name="LocalUserGrid"  Margin="5 0 5 5" ItemsSource="{Binding LocalUserLst,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                      ColumnWidth="*"  Style="{StaticResource NormalDataGrid}"  Height="500"  ScrollViewer.VerticalScrollBarVisibility="Auto">

                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="操作" Width="120" >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="编辑" Width="60" Style="{StaticResource TextButton}" Command="{Binding DataContext.EditLocalUserCommand,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGrid}}" 
                                            CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGrid},Path=SelectedItem}"/>

                                                <Button Content="删除" Width="60" Style="{StaticResource TextButton}" Command="{Binding DataContext.DeleteLocalUserCommand,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGrid}}" 
                                            CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGrid},Path=SelectedItem}"/>

                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="用户ID" Width="*" Binding="{Binding user_id}">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style>
                                            <Setter Property="FrameworkElement.HorizontalAlignment" Value="Center"/>
                                            <Setter Property="FrameworkElement.VerticalAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <!--<DataGridTextColumn Header="用户名" Width="*" Binding="{Binding user_name}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="FrameworkElement.VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>-->
                                <DataGridTextColumn Header="密码" Width="*" Binding="{Binding user_password,Converter={StaticResource PwdConverter}}">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style>
                                            <Setter Property="FrameworkElement.HorizontalAlignment" Value="Center"/>
                                            <Setter Property="FrameworkElement.VerticalAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Vertical" Margin="5">
                    <StackPanel Orientation="Horizontal" Width="350" HorizontalAlignment="Left">

                        <Label Content="登入登出,通知其他交互对象"
                    HorizontalContentAlignment="Left" Margin="5,0,5,0"  
                   Style="{StaticResource NormalLabel}"/>
                        <controls:TipsLabel   TipName="[login_config_page]inform_ecs_object" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal"  Margin="130 15 0 5">
                        <CheckBox x:Name="isEcsCommEnableChkbox"
                      IsChecked="{Binding LoginInformRocsEnable,Mode=TwoWay}" Content="通知ROCS" Width="200"  VerticalContentAlignment="Center" Foreground="White"/>
                        <CheckBox x:Name="isEcsCommEnableChkbox1"
                      IsChecked="{Binding LoginInformRemotePLCEnable,Mode=TwoWay}" Content="通知中控PLC" Width="200"  VerticalContentAlignment="Center" Foreground="White"/>


                    </StackPanel>

                </StackPanel>
            </StackPanel>

        </GroupBox>
      
        <Button  Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="1"
            Command="{Binding ApplyCommand}" CommandParameter="{Binding ElementName=iCraneCount,Path=Text}"
                Style="{StaticResource  NormalButton}"  Content="应用"  Width="250"  Height="50" Margin="244,58,154,58"/>
    </StackPanel>
</UserControl>
